Управление памятью в JavaScript выполняется автоматически и незаметно.

## Достижимость
Основной концепцией управления памятью в JavaScript является принцип _достижимости_.

Если упростить, то «достижимые» значения – это те, которые доступны или используются. Они гарантированно находятся в памяти.

1. Существует базовое множество достижимых значений, которые не могут быть удалены.
    
    Например:
    
    - Выполняемая в данный момент функция, её локальные переменные и параметры.
    - Другие функции в текущей цепочке вложенных вызовов, их локальные переменные и параметры.
    - Глобальные переменные.
    - (некоторые другие внутренние значения)
    
    Эти значения мы будем называть _корнями_.
    
2. Любое другое значение считается достижимым, если оно доступно из корня по ссылке или по цепочке ссылок.
    
	Например, если в глобальной переменной есть объект, и он имеет свойство, в котором хранится ссылка на другой объект, то _этот_ объект считается достижимым. И те, на которые он ссылается, тоже достижимы. Далее вы познакомитесь с подробными примерами на эту тему.

Корневые объекты - это объекты, на которые указывает непосредственно V8 или веб-браузер. Например, объекты, на которые указывают локальные переменные, являются корневыми объектами, поскольку стек сканируется на наличие корней. Глобальные объекты являются корнями, поскольку они всегда доступны. Объекты браузера, такие как элементы DOM, также являются корнями, хотя в некоторых случаях на них могут быть слабые ссылки.

```JS
// В user находится ссылка на объект
let user = {
	name: 'John';
}
```
![[Pasted image 20240907103016.png]]
```JS
user = null;
// Теряем ссылку
```
![[Pasted image 20240907103047.png]]
Теперь объект John становится недостижимым. К нему нет доступа, на него нет ссылок. Сборщик мусора удалит эти данные и освободит память.

## Исходящие и входящие ссылки
Исходящие ссылки не имеют значения. Только входящие ссылки могут сделать объект достижимым. Объект John теперь недостижим и будет удалён из памяти со всеми своими данными, которые также стали недоступны.
![[Pasted image 20240907103152.png]]
## Внутренний алгоритм
Основной алгоритм сборки мусора называется «алгоритм пометок» (от англ. «mark-and-sweep»).

Согласно этому алгоритму, сборщик мусора регулярно выполняет следующие шаги (напоминает покраску графа):

- Сборщик мусора «помечает» (запоминает) все корневые объекты.
- Затем он идёт по ним и «помечает» все ссылки из них.
- Затем он идёт по отмеченным объектам и отмечает их ссылки. Все посещённые объекты запоминаются, чтобы в будущем не посещать один и тот же объект дважды.
- …И так далее, пока не будут посещены все достижимые (из корней) ссылки.
- Все непомеченные объекты удаляются.